# gopls-mcp æŠ€æœ¯æ–¹æ¡ˆ

## ä¸€ã€èƒŒæ™¯

### 1.1 å½“å‰ç°çŠ¶

åœ¨ AI è¾…åŠ©ç¼–ç¨‹é¢†åŸŸï¼ŒLLMï¼ˆå¤§è¯­è¨€æ¨¡å‹ï¼‰å·²å¹¿æ³›åº”ç”¨äºä»£ç ç”Ÿæˆã€ä»£ç å®¡æŸ¥ã€é—®é¢˜è§£ç­”ç­‰åœºæ™¯ã€‚ç„¶è€Œï¼Œå¯¹äº Go è¯­è¨€è¿™ç±»é™æ€ç±»å‹è¯­è¨€ï¼ŒLLM åœ¨å¤„ç†ä»¥ä¸‹ä»»åŠ¡æ—¶ä»å­˜åœ¨æ˜æ˜¾ä¸è¶³ï¼š

- **ç²¾ç¡®çš„ä»£ç åˆ†æ**ï¼šç±»å‹æ¨æ–­ã€æ¥å£å®ç°ã€ä¾èµ–å…³ç³»åˆ†æ
- **å‡†ç¡®çš„é”™è¯¯è¯Šæ–­**ï¼šç¼–è¯‘é”™è¯¯ã€ç±»å‹ä¸åŒ¹é…ã€æœªä½¿ç”¨çš„å˜é‡
- **æ·±åº¦çš„ä»£ç å¯¼èˆª**ï¼šè·³è½¬å®šä¹‰ã€æŸ¥æ‰¾å¼•ç”¨ã€è·¨åŒ…è°ƒç”¨é“¾
- **æ™ºèƒ½çš„ä»£ç è¡¥å…¨**ï¼šåŸºäºç±»å‹ç³»ç»Ÿçš„ä¸Šä¸‹æ–‡è¡¥å…¨
- **å¤æ‚çš„é‡æ„æ“ä½œ**ï¼šé‡å‘½åç¬¦å·ã€æå–å‡½æ•°ã€å®‰å…¨åˆ é™¤

### 1.2 gopls ç®€ä»‹

**gopls** æ˜¯ Go è¯­è¨€å®˜æ–¹çš„ Language Server Protocol (LSP) å®ç°ï¼Œæä¾›äº†å®Œæ•´ã€å‡†ç¡®çš„ Go è¯­è¨€åˆ†æèƒ½åŠ›ï¼š

- ç”± Go å®˜æ–¹å›¢é˜Ÿç»´æŠ¤ï¼Œä¸ Go è¯­è¨€åŒæ­¥æ¼”è¿›
- å®Œæ•´çš„ç±»å‹ç³»ç»Ÿå’Œæ¨¡å—ç³»ç»Ÿæ”¯æŒ
- æ”¯æŒæ³›å‹ã€go.work å·¥ä½œåŒºã€cgo ç­‰æ‰€æœ‰ Go ç‰¹æ€§
- å·²è¢« VS Codeã€Vimã€Emacs ç­‰ä¸»æµç¼–è¾‘å™¨å¹¿æ³›é‡‡ç”¨

### 1.3 MCP åè®®

**Model Context Protocol (MCP)** æ˜¯ Anthropic æ¨å‡ºçš„å¼€æ”¾åè®®ï¼Œç”¨äºåœ¨ AI åº”ç”¨å’Œå¤–éƒ¨å·¥å…·/æ•°æ®æºä¹‹é—´å»ºç«‹æ ‡å‡†è¿æ¥ï¼š

- æ ‡å‡†åŒ–çš„å·¥å…·è°ƒç”¨æ¥å£
- æ”¯æŒ stdioã€SSE ç­‰å¤šç§ä¼ è¾“æ–¹å¼
- å·²æœ‰ä¸°å¯Œçš„ Go SDK æ”¯æŒ
- è¢« Claude Codeã€Cursor ç­‰ AI ç¼–ç¨‹å·¥å…·é‡‡ç”¨

---

## äºŒã€ç—›ç‚¹åˆ†æ

### 2.1 LLM çš„å±€é™

| ç—›ç‚¹ | æè¿° | å½±å“ |
|------|------|------|
| **é™æ€åˆ†æèƒ½åŠ›å¼±** | LLM åªèƒ½é€šè¿‡ä»£ç æ¨¡å¼åŒ¹é…ï¼Œæ— æ³•çœŸæ­£ç†è§£ç±»å‹ç³»ç»Ÿ | å¯¹æ³›å‹ã€æ¥å£ã€æ¨¡å—ç³»ç»Ÿç†è§£ä¸å‡†ç¡® |
| **ä¸Šä¸‹æ–‡é™åˆ¶** | å¤§å‹ä»£ç åº“æ— æ³•å®Œå…¨æ”¾å…¥ä¸Šä¸‹æ–‡çª—å£ | éš¾ä»¥åˆ†æè·¨æ–‡ä»¶ã€è·¨åŒ…çš„ä¾èµ–å…³ç³» |
| **å¹»è§‰é—®é¢˜** | LLM å¯èƒ½ç¼–é€ ä¸å­˜åœ¨çš„ API æˆ–é”™è¯¯ä¿¡æ¯ | ç»™å‡ºè¯¯å¯¼æ€§çš„ä»£ç å»ºè®® |
| **æ— æ³•å®æ—¶åé¦ˆ** | æ— æ³•è·å–æœ€æ–°çš„ä»£ç çŠ¶æ€å’Œç¼–è¯‘é”™è¯¯ | å»ºè®®å¯èƒ½å·²è¿‡æ—¶ |

### 2.2 ç°æœ‰å·¥å…·çš„å±€é™

| å·¥å…· | å±€é™ |
|------|------|
| **ç›´æ¥è°ƒç”¨ç¼–è¯‘å™¨** | åªèƒ½è·å–ç¼–è¯‘é”™è¯¯ï¼Œæ— æ³•åšä»£ç è¡¥å…¨ã€è·³è½¬å®šä¹‰ç­‰ |
| **æ­£åˆ™/é™æ€åˆ†æ** | æ— æ³•å‡†ç¡®ç†è§£ Go çš„ç±»å‹ç³»ç»Ÿå’Œæ¨¡å—ç³»ç»Ÿ |
| **åœ¨çº¿ APIï¼ˆå¦‚ go.devï¼‰** | éœ€è¦ç½‘ç»œã€æœ‰éšç§é—®é¢˜ã€æ— æ³•åˆ†ææœ¬åœ°ä»£ç  |

### 2.3 å¼€å‘è€…éœ€æ±‚

å¼€å‘è€…åœ¨æ—¥å¸¸å·¥ä½œä¸­éœ€è¦ AI åŠ©æ‰‹èƒ½å¤Ÿï¼š

1. **ç²¾ç¡®å›ç­”ä»£ç é—®é¢˜**ï¼š"è¿™ä¸ªå‡½æ•°åœ¨å“ªé‡Œè¢«è°ƒç”¨ï¼Ÿ"ã€"è¿™ä¸ªæ¥å£æœ‰å“ªäº›å®ç°ï¼Ÿ"
2. **æä¾›å‡†ç¡®çš„ä»£ç å»ºè®®**ï¼š"å¦‚ä½•è¡¥å…¨è¿™æ®µä»£ç ï¼Ÿ"ã€"è¿™é‡Œæœ‰å“ªäº›é”™è¯¯ï¼Ÿ"
3. **æ‰§è¡Œå¤æ‚çš„é‡æ„**ï¼š"å°†è¿™ä¸ªæ–¹æ³•é‡å‘½åå¹¶æ›´æ–°æ‰€æœ‰å¼•ç”¨"
4. **ç†è§£é¡¹ç›®ç»“æ„**ï¼š"è¿™ä¸ªåŒ…çš„ä¾èµ–å…³ç³»å¦‚ä½•ï¼Ÿ"ã€"é¡¹ç›®çš„æ ¸å¿ƒæ¨¡å—æœ‰å“ªäº›ï¼Ÿ"

---

## ä¸‰ã€ç›®æ ‡

### 3.1 æ ¸å¿ƒç›®æ ‡

æ„å»ºä¸€ä¸ª **åŸºäº gopls çš„ MCP CLI å®¢æˆ·ç«¯**ï¼Œå°† gopls çš„ä¸“ä¸š Go è¯­è¨€åˆ†æèƒ½åŠ›é€šè¿‡ MCP åè®®æš´éœ²ç»™ LLMï¼Œä½¿ AI åŠ©æ‰‹èƒ½å¤Ÿï¼š

- âœ… ç²¾ç¡®åˆ†æ Go ä»£ç ï¼ˆç±»å‹ã€ä¾èµ–ã€ç»“æ„ï¼‰
- âœ… å‡†ç¡®è¯Šæ–­ä»£ç é—®é¢˜ï¼ˆç¼–è¯‘é”™è¯¯ã€è­¦å‘Šã€å»ºè®®ï¼‰
- âœ… æ™ºèƒ½è¡¥å…¨å’Œé‡æ„ï¼ˆåŸºäºç±»å‹ç³»ç»Ÿï¼‰
- âœ… æ·±åº¦ä»£ç å¯¼èˆªï¼ˆå®šä¹‰ã€å¼•ç”¨ã€è°ƒç”¨é“¾ï¼‰
- âœ… æ”¯æŒæ‰€æœ‰ Go ç‰¹æ€§ï¼ˆæ³›å‹ã€æ¨¡å—ã€cgoã€go.workï¼‰

### 3.2 éç›®æ ‡

- âŒ ä¸å®ç°ä»£ç ç¼–è¾‘åŠŸèƒ½ï¼ˆåº”ç”±ç¼–è¾‘å™¨/IDE å®Œæˆï¼‰
- âŒ ä¸æ›¿ä»£ gopls æœ¬èº«ï¼ˆåªæ˜¯ä½œä¸º LSP å®¢æˆ·ç«¯ï¼‰
- âŒ ä¸æ”¯æŒå…¶ä»–è¯­è¨€ï¼ˆä¸“æ³¨äº Goï¼‰

### 3.3 æˆåŠŸæ ‡å‡†

| æŒ‡æ ‡ | ç›®æ ‡ |
|------|------|
| **åŠŸèƒ½è¦†ç›–ç‡** | è¦†ç›– gopls æ ¸å¿ƒèƒ½åŠ›çš„ 80%+ |
| **å“åº”æ—¶é—´** | å•æ¬¡å·¥å…·è°ƒç”¨ < 500msï¼ˆå†·å¯åŠ¨é™¤å¤–ï¼‰ |
| **å‡†ç¡®ç‡** | ä»£ç è¯Šæ–­å‡†ç¡®ç‡ > 95% |
| **å…¼å®¹æ€§** | æ”¯æŒ Go 1.18+ï¼ˆå«æ³›å‹ï¼‰ã€go.work |

---

## å››ã€è§£å†³æ–¹æ¡ˆ

### 4.1 æ€»ä½“æ€è·¯

```mermaid
graph TB
    LLM[LLM Claude/GPT<br/>å¸®æˆ‘åˆ†æè¿™æ®µä»£ç æœ‰ä»€ä¹ˆé—®é¢˜]

    LLM -->|MCP Tool Call| CLI[gopls-mcp CLI<br/>via stdin/stdout]

    CLI --> MCP[MCP Server Layer]
    MCP --> Tools[Tools:<br/>analyze_code<br/>go_to_definition<br/>find_references<br/>get_completions<br/>get_hover<br/>list_symbols<br/>rename_symbol]

    CLI --> Bridge[Bridge Layer<br/>MCP Request â†’ LSP Request]
    Bridge --> VDM[Virtual Document Manager]
    Bridge --> LSPA[LSP Protocol Adapter]

    CLI --> Client[gopls LSP Client]
    Client --> PM[Process Manager]
    Client --> CP[Connection Pool]
    Client --> Cache[Cache]

    CLI -->|LSP JSON-RPC over TCP/Unix Socket| gopls[gopls Server<br/>å®˜æ–¹ Go Language Server]

    style LLM fill:#e1f5ff
    style CLI fill:#fff4e1
    style gopls fill:#e8f5e9
    style MCP fill:#f3e5f5
    style Bridge fill:#fce4ec
    style Client fill:#fff9c4
```

### 4.2 æ ¸å¿ƒè®¾è®¡

#### 4.2.1 æ¶æ„åˆ†å±‚

```mermaid
graph TD
    A[MCP Protocol Layer<br/>stdin/stdout + JSON-RPC 2.0] --> B[Tool Layer<br/>è¾“å…¥éªŒè¯ â†’ ä¸šåŠ¡é€»è¾‘ â†’ è¾“å‡ºè½¬æ¢]
    B --> C[Bridge Layer<br/>MCP Request â†” LSP Request è½¬æ¢å™¨]
    C --> D[gopls Client Layer<br/>æ–‡æ¡£åŒæ­¥ã€ç‰ˆæœ¬ç®¡ç†ã€è¿æ¥æ± ã€ç¼“å­˜]

    style A fill:#e3f2fd
    style B fill:#fff3e0
    style C fill:#f1f8e9
    style D fill:#fce4ec
```

#### 4.2.2 å…³é”®è®¾è®¡å†³ç­–

| å†³ç­–ç‚¹ | é€‰æ‹© | ç†ç”± |
|--------|------|------|
| **ä¼ è¾“åè®®** | MCP stdio | æ ‡å‡†åè®®ã€å…¼å®¹æ€§å¥½ã€ä½å»¶è¿Ÿ |
| **gopls è¿æ¥** | TCP/Unix Socket | LSP æ ‡å‡†ã€æ”¯æŒå¹¶å‘ |
| **æ–‡æ¡£ç®¡ç†** | è™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿ | æ— éœ€å†™å…¥ç£ç›˜ã€æ”¯æŒä¸´æ—¶ä»£ç  |
| **å¹¶å‘æ¨¡å‹** | goroutine + è¿æ¥æ±  | é«˜æ•ˆå¤ç”¨ gopls è¿›ç¨‹ |
| **ç¼“å­˜ç­–ç•¥** | æ–‡æ¡£ç‰ˆæœ¬ + ç»“æœç¼“å­˜ | å‡å°‘ LSP è°ƒç”¨ã€æå‡æ€§èƒ½ |

---

## äº”ã€ä¸šåŠ¡æ¶æ„å›¾

```mermaid
graph TB
    subgraph Scenarios[ä½¿ç”¨åœºæ™¯]
        S1[ä»£ç å®¡æŸ¥åœºæ™¯<br/>è¿™æ®µä»£ç æœ‰ä»€ä¹ˆé—®é¢˜ï¼Ÿ]
        S2[ä»£ç ç”Ÿæˆåœºæ™¯<br/>å¸®æˆ‘å®ç°ä¸€ä¸ª HTTP Server]
        S3[é—®é¢˜è§£ç­”åœºæ™¯<br/>è¿™ä¸ªå‡½æ•°åœ¨å“ªé‡Œè¢«è°ƒç”¨ï¼Ÿ]
    end

    S1 --> LLM
    S2 --> LLM
    S3 --> LLM

    subgraph LLMLayer[LLM å±‚]
        LLM[Claude / GPT-4 + MCP Client Plugin<br/>ç†è§£ç”¨æˆ·æ„å›¾ï¼Œè°ƒç”¨åˆé€‚çš„ MCP å·¥å…·]
    end

    LLM -->|MCP Tool Call| MCP[gopls-mcp æœåŠ¡å±‚]

    subgraph MCPLayer
        MCP --> T1[åˆ†æç±»å·¥å…·<br/>analyze_code<br/>list_symbols]
        MCP --> T2[å¯¼èˆªç±»å·¥å…·<br/>go_to_definition<br/>find_references<br/>get_hover]
        MCP --> T3[é‡æ„ç±»å·¥å…·<br/>rename_symbol<br/>extract_function]
    end

    MCP -->|LSP Request| gopls[gopls å¼•æ“å±‚<br/>ç±»å‹æ£€æŸ¥ã€è¯­æ³•åˆ†æã€ä¾èµ–åˆ†æã€ä»£ç è¡¥å…¨ã€é‡æ„æ”¯æŒ]

    style Scenarios fill:#e3f2fd
    style LLMLayer fill:#fff3e0
    style MCPLayer fill:#f1f8e9
    style gopls fill:#e8f5e9
```

---

## å…­ã€æŠ€æœ¯æ¶æ„å›¾

```mermaid
graph TB
    External[å¤–éƒ¨ç³»ç»Ÿ<br/>Claude Code / Cursor / IDE with MCP Support]

    External -->|stdin/stdout JSON-RPC| App[gopls-mcp Application<br/>Go CLI Application]

    App --> CMD[cmd/gopls-mcp<br/>main.go - CLI å…¥å£ï¼Œé…ç½®è§£æï¼Œå¯åŠ¨ MCP Server]

    CMD --> MCP1[internal/mcp<br/>server.go - MCP Server åˆ›å»ºã€å·¥å…·æ³¨å†Œ<br/>transport.go - Stdio ä¼ è¾“å±‚å¤„ç†<br/>protocol.go - JSON-RPC æ¶ˆæ¯è§£æ]

    MCP1 --> TOOLS[internal/tools<br/>analyze.go - analyze_code<br/>definition.go - go_to_definition<br/>references.go - find_references<br/>completion.go - get_completions<br/>hover.go - get_hover<br/>symbols.go - list_symbols<br/>rename.go - rename_symbol<br/>types.go - å·¥å…·è¾“å…¥/è¾“å‡ºç±»å‹å®šä¹‰]

    TOOLS --> BRIDGE[internal/bridge<br/>bridge.go - MCP â†’ LSP è¯·æ±‚è½¬æ¢å™¨<br/>converter.go - LSP ç»“æœ â†’ MCP å“åº”è½¬æ¢]

    BRIDGE --> CLIENT[internal/goplsclient<br/>client.go - gopls è¿›ç¨‹ç®¡ç†ã€è¿æ¥æ± <br/>document.go - è™šæ‹Ÿæ–‡æ¡£åŒæ­¥ didOpen/didChange<br/>lsp.go - LSP åè®®å°è£… request/notification<br/>cache.go - ç»“æœç¼“å­˜å‡å°‘é‡å¤ LSP è°ƒç”¨]

    CLIENT -->|TCP / Unix Socket| goplsProcess[gopls Process<br/>ç‹¬ç«‹è¿›ç¨‹ï¼Œç”± client å¯åŠ¨<br/>gopls serve --listen=localhost:0]

    style External fill:#e1f5fe
    style App fill:#fff8e1
    style CMD fill:#f3e5f5
    style MCP1 fill:#e0f2f1
    style TOOLS fill:#fce4ec
    style BRIDGE fill:#fff9c4
    style CLIENT fill:#e8f5e9
    style goplsProcess fill:#ffebee
```

---

## ä¸ƒã€ç»„ä»¶æµç¨‹å›¾

### 7.1 å®Œæ•´è°ƒç”¨æµç¨‹

```mermaid
sequenceDiagram
    participant User as ç”¨æˆ·
    participant LLM as LLM
    participant M as gopls-mcp
    participant G as gopls

    User->>LLM: è¿™æ®µä»£ç æœ‰é—®é¢˜å—ï¼Ÿ
    LLM->>LLM: è§£ææ„å›¾ï¼Œéœ€è¦è°ƒç”¨ analyze_code å·¥å…·
    LLM->>M: MCP Request: {tool: "analyze_code", input: {code: "...", file_path: "main.go"}}

    Note over M: 1. è§£æè¾“å…¥<br/>2. åˆ›å»ºè™šæ‹Ÿæ–‡æ¡£<br/>3. å‘é€ didOpen
    M->>G: LSP: didOpen
    Note over M: 4. å‘é€ diagnostics
    M->>G: LSP: textDocument/diagnostic
    G-->>M: LSP Response: [{range, severity, message, source}]

    Note over M: 5. è½¬æ¢ä¸º MCP æ ¼å¼
    M-->>LLM: MCP Response: {diagnostics: [{line, message, severity}]}

    Note over LLM: 6. ç»¼åˆåˆ†æï¼Œç”Ÿæˆå›ç­”
    LLM-->>User: ä»£ç ç¬¬ 10 è¡Œæœ‰é—®é¢˜ï¼šå˜é‡ x æœªå®šä¹‰
```

### 7.2 æ ¸å¿ƒç»„ä»¶äº¤äº’

#### Tool Handler æµç¨‹

```mermaid
graph LR
    A[è¾“å…¥éªŒè¯<br/>å‚æ•°æ ¡éªŒ<br/>ç±»å‹è½¬æ¢<br/>é»˜è®¤å€¼] --> B[ä¸šåŠ¡é€»è¾‘<br/>è·å– gopls client<br/>è°ƒç”¨ LSP]
    B --> C[è¾“å‡ºè½¬æ¢<br/>LSP â†’ MCP æ ¼å¼è½¬æ¢<br/>é”™è¯¯å¤„ç†]

    style A fill:#e3f2fd
    style B fill:#fff3e0
    style C fill:#e8f5e9
```

#### Virtual Document Manager

```mermaid
graph TB
    D[Document<br/>URI: file:///virtual/main.go<br/>Version: 1<br/>Content: package main...]

    D --> O[Create code path<br/>â†’ didOpen]
    D --> U[Update uri code<br/>â†’ didChange incremental]
    D --> Del[Delete uri<br/>â†’ didClose]
    D --> G[Get uri<br/>â†’ Document]
    D --> E[Evict uri<br/>â†’ LRU ç¼“å­˜æ¸…ç†]

    style D fill:#fff9c4
    style O fill:#c8e6c9
    style U fill:#c8e6c9
    style Del fill:#c8e6c9
    style G fill:#c8e6c9
    style E fill:#ffccbc
```

#### gopls Connection Pool

```mermaid
graph TB
    P[Pool<br/>maxIdle: 3<br/>maxActive: 10<br/>timeout: 30s]

    P --> S1[1. å°è¯•ä»ç©ºé—²æ± è·å–]
    P --> S2[2. è‹¥æ— ç©ºé—²è¿æ¥ä¸”æœªè¾¾ä¸Šé™<br/>åˆ›å»ºæ–°è¿æ¥]
    P --> S3[3. è‹¥å·²è¾¾ä¸Šé™<br/>ç­‰å¾…æˆ–è¿”å›é”™è¯¯]
    P --> S4[4. ä½¿ç”¨å®Œæ¯•åå½’è¿˜è¿æ¥]

    style P fill:#e1f5fe
    style S1 fill:#c8e6c9
    style S2 fill:#fff9c4
    style S3 fill:#ffccbc
    style S4 fill:#c8e6c9
```

#### Result Cache

```mermaid
graph TB
    K[CacheKey<br/>URI: file:///virtual/main.go<br/>Version: 1<br/>Method: textDocument/diagnostic<br/>Params: checksum]

    K --> POL[ç¼“å­˜ç­–ç•¥<br/>â€¢ æ–‡æ¡£ç‰ˆæœ¬å˜åŒ–æ—¶è‡ªåŠ¨å¤±æ•ˆ<br/>â€¢ TTL: 5 åˆ†é’Ÿ<br/>â€¢ LRU: æœ€å¤š 1000 æ¡]

    style K fill:#f3e5f5
    style POL fill:#fff9c4
```

### 7.3 å…³é”®æ•°æ®æµ

#### MCP Request â†’ LSP Request

```mermaid
graph TD
    MCP["MCP Request<br/>tool: go_to_definition<br/>input: file_path, line, col, code"]

    MCP --> B1["Bridge å¤„ç† 1<br/>ç¡®ä¿ document å·²åˆ›å»º didOpen"]
    B1 --> B2["Bridge å¤„ç† 2<br/>æ„å»º URI: file:///virtual/main.go"]
    B2 --> B3["Bridge å¤„ç† 3<br/>æ„å»º Position: line 9, character 4"]

    B3 --> LSP["LSP Request<br/>jsonrpc 2.0, id 1<br/>method: textDocument/definition<br/>params: textDocument uri, position"]

    style MCP fill:#e3f2fd
    style B1 fill:#fff9c4
    style B2 fill:#fff9c4
    style B3 fill:#fff9c4
    style LSP fill:#e8f5e9
```

#### LSP Response â†’ MCP Response

```mermaid
graph TD
    LSPR["LSP Response<br/>jsonrpc 2.0, id 1<br/>result: uri, range start end"]

    LSPR --> BR1["Bridge è½¬æ¢ 1<br/>æå–è·¯å¾„: utils.go"]
    BR1 --> BR2["Bridge è½¬æ¢ 2<br/>è½¬æ¢è¡Œåˆ—: line 6, col 1<br/>LSP 0-based â†’ MCP 1-based"]
    BR2 --> BR3["Bridge è½¬æ¢ 3<br/>è·å–ä»£ç ç‰‡æ®µ å¯é€‰"]

    BR3 --> MCPR["MCP Response<br/>definition: file_path, line, col,<br/>end_line, end_col, snippet"]

    style LSPR fill:#e8f5e9
    style BR1 fill:#fff9c4
    style BR2 fill:#fff9c4
    style BR3 fill:#fff9c4
    style MCPR fill:#e3f2fd
```

---

## å…«ã€å·¥å…·å®šä¹‰

### 8.1 å·¥å…·æ¸…å•

| å·¥å…·åç§° | åŠŸèƒ½æè¿° | LSP æ˜ å°„ | ä¼˜å…ˆçº§ | æ¥æº |
|---------|---------|----------|--------|------|
| **analyze_code** | åˆ†æä»£ç å¹¶è¿”å›è¯Šæ–­ä¿¡æ¯ | `textDocument/diagnostic` | P0 | åŸæœ‰ |
| **go_to_definition** | è·³è½¬åˆ°ç¬¦å·å®šä¹‰ | `textDocument/definition` | P0 | åŸæœ‰ |
| **find_references** | æŸ¥æ‰¾ç¬¦å·å¼•ç”¨ | `textDocument/references` | P0 | åŸæœ‰ |
| **get_hover** | è·å–æ‚¬åœæ–‡æ¡£ä¿¡æ¯ | `textDocument/hover` | P1 | åŸæœ‰ |
| **list_symbols** | åˆ—å‡ºæ–‡ä»¶ä¸­çš„ç¬¦å·ï¼ˆæ”¯æŒå±‚çº§ï¼‰ | `textDocument/documentSymbol` | P1 | å€Ÿé‰´ Serena |
| **search_symbols** | æŒ‰åç§°è·¯å¾„æ¨¡å¼æœç´¢ç¬¦å· | `workspace/symbol` | P1 | ğŸ†• å€Ÿé‰´ Serena |
| **get_completions** | è·å–ä»£ç è¡¥å…¨å»ºè®® | `textDocument/completion` | P1 | åŸæœ‰ |
| **search_pattern** | æ­£åˆ™è¡¨è¾¾å¼æœç´¢ä»£ç  | è‡ªå®ç° | P2 | ğŸ†• å€Ÿé‰´ Serena |
| **rename_symbol** | é‡å‘½åç¬¦å· | `textDocument/rename` | P2 | åŸæœ‰ |
| **format_code** | æ ¼å¼åŒ–ä»£ç  | `textDocument/formatting` | P2 | åŸæœ‰ |
| **fix_code** | è‡ªåŠ¨ä¿®å¤é—®é¢˜ | `textDocument/codeAction` | P2 | åŸæœ‰ |
| **get_call_hierarchy** | è·å–è°ƒç”¨å±‚æ¬¡ç»“æ„ | `callHierarchy/incomingCalls` | P2 | ğŸ†• æ–°å¢ |
| **list_packages** | åˆ—å‡ºé¡¹ç›®çš„åŒ…ç»“æ„ | è‡ªå®ç° | P2 | ğŸ†• æ–°å¢ |

### 8.2 ä» Serena å€Ÿé‰´çš„è®¾è®¡æ¨¡å¼

#### 8.2.1 åç§°è·¯å¾„æ¨¡å¼

å€Ÿé‰´ Serena çš„ `name_path` è®¾è®¡ï¼Œæ”¯æŒçµæ´»çš„ç¬¦å·åŒ¹é…ï¼š

```
# ç®€å•åç§°ï¼šåŒ¹é…ä»»ä½•åŒåç¬¦å·
"HandleRequest"

# ç›¸å¯¹è·¯å¾„ï¼šåŒ¹é…åç¼€
"http/HandleRequest"  â†’ åŒ¹é… ...http.HandleRequest

# ç»å¯¹è·¯å¾„ï¼šç²¾ç¡®åŒ¹é…
"/github.com/user/pkg/HandleRequest"

# Go ç‰¹æœ‰ï¼šåŒ…è·¯å¾„ç¬¦å·
"net/http.ListenAndServe"
```

#### 8.2.2 é€šç”¨å‚æ•°æ¨¡å¼

å€Ÿé‰´ Serena çš„å‚æ•°è®¾è®¡é£æ ¼ï¼š

| å‚æ•°å | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
|--------|------|--------|------|
| `depth` | int | 0 | æ£€ç´¢æ·±åº¦ï¼ˆ0=å½“å‰å±‚çº§ï¼Œ1=ç›´æ¥å­å…ƒç´ ï¼‰ |
| `include_body` | bool | false | æ˜¯å¦åŒ…å«ç¬¦å·ä½“ |
| `include_info` | bool | false | æ˜¯å¦åŒ…å«æ–‡æ¡£å’Œç­¾å |
| `include_kinds` | []string | nil | åŒ…å«çš„ç¬¦å·ç±»å‹è¿‡æ»¤ |
| `exclude_kinds` | []string | nil | æ’é™¤çš„ç¬¦å·ç±»å‹è¿‡æ»¤ |
| `max_results` | int | 100 | æœ€å¤§è¿”å›ç»“æœæ•° |
| `max_chars` | int | -1 | æœ€å¤§è¿”å›å­—ç¬¦æ•°ï¼ˆ-1=æ— é™åˆ¶ï¼‰ |

### 8.3 è¯¦ç»†å®šä¹‰

#### 8.2.1 analyze_code

**åŠŸèƒ½**ï¼šåˆ†æ Go ä»£ç ï¼Œè¿”å›ç¼–è¯‘é”™è¯¯ã€ç±»å‹é”™è¯¯ã€è­¦å‘Šç­‰è¯Šæ–­ä¿¡æ¯

**è¾“å…¥**ï¼š

```json
{
  "code": "package main\n\nfunc main() {\n    var x int\n    println(y)\n}",
  "file_path": "main.go",
  "include_warnings": true
}
```

**è¾“å‡º**ï¼š

```json
{
  "file_path": "main.go",
  "diagnostics": [
    {
      "line": 4,
      "col": 12,
      "end_line": 4,
      "end_col": 13,
      "severity": "error",
      "message": "undefined: y",
      "code": "undeclaredname",
      "source": "gopls",
      "suggestion": "Did you mean 'x'?"
    }
  ]
}
```

#### 8.2.2 go_to_definition

**åŠŸèƒ½**ï¼šè·³è½¬åˆ°ç¬¦å·çš„å®šä¹‰ä½ç½®

**è¾“å…¥**ï¼š

```json
{
  "code": "package main\n\nfunc hello() {}\n\nfunc main() {\n    hello()\n}",
  "file_path": "main.go",
  "line": 5,
  "col": 5
}
```

**è¾“å‡º**ï¼š

```json
{
  "definition": {
    "file_path": "main.go",
    "line": 3,
    "col": 1,
    "end_line": 3,
    "end_col": 13,
    "name": "hello",
    "kind": "function",
    "signature": "func hello()"
  }
}
```

#### 8.2.3 find_references

**åŠŸèƒ½**ï¼šæŸ¥æ‰¾ç¬¦å·çš„æ‰€æœ‰å¼•ç”¨ä½ç½®

**è¾“å…¥**ï¼š

```json
{
  "code": "...",
  "file_path": "main.go",
  "line": 3,
  "col": 6,
  "include_declaration": true
}
```

**è¾“å‡º**ï¼š

```json
{
  "symbol": {
    "name": "hello",
    "kind": "function"
  },
  "references": [
    {
      "file_path": "main.go",
      "line": 3,
      "col": 6,
      "is_definition": true
    },
    {
      "file_path": "main.go",
      "line": 6,
      "col": 5,
      "is_definition": false
    }
  ],
  "total_count": 2
}
```

#### 8.2.4 get_hover

**åŠŸèƒ½**ï¼šè·å–ç¬¦å·çš„æ‚¬åœæ–‡æ¡£ä¿¡æ¯

**è¾“å…¥**ï¼š

```json
{
  "code": "...",
  "file_path": "main.go",
  "line": 6,
  "col": 5
}
```

**è¾“å‡º**ï¼š

```json
{
  "hover": {
    "range": {
      "line": 6,
      "col": 5,
      "end_line": 6,
      "end_col": 10
    },
    "contents": {
      "signature": "func hello()",
      "documentation": "hello prints a greeting",
      "kind": "function"
    }
  }
}
```

#### 8.3.5 list_symbolsï¼ˆğŸ†• å€Ÿé‰´ Serenaï¼‰

**åŠŸèƒ½**ï¼šåˆ—å‡ºæ–‡ä»¶ä¸­çš„æ‰€æœ‰ç¬¦å·ï¼ˆå‡½æ•°ã€ç±»å‹ã€å˜é‡ç­‰ï¼‰ï¼Œæ”¯æŒå±‚çº§æ§åˆ¶

**è¾“å…¥**ï¼š

```json
{
  "code": "package main\n\ntype Config struct {\n    Host string\n}\n\nfunc (c *Config) Run() {}\n\nfunc main() {}",
  "file_path": "main.go",
  "depth": 1,
  "include_body": false,
  "include_info": true,
  "include_kinds": ["struct", "function", "method"],
  "max_results": 50
}
```

**è¾“å‡º**ï¼š

```json
{
  "symbols": [
    {
      "name": "Config",
      "name_path": "Config",
      "kind": "struct",
      "line": 3,
      "col": 1,
      "end_line": 5,
      "end_col": 2,
      "signature": "type Config struct",
      "children": [
        {"name": "Host", "name_path": "Config.Host", "kind": "field", "line": 4}
      ]
    },
    {
      "name": "Run",
      "name_path": "Config.Run",
      "kind": "method",
      "line": 6,
      "col": 14,
      "signature": "func (c *Config) Run()",
      "receiver": "Config"
    },
    {
      "name": "main",
      "name_path": "main",
      "kind": "function",
      "line": 8,
      "col": 1,
      "signature": "func main()"
    }
  ],
  "total_count": 3
}
```

#### 8.3.6 search_symbolsï¼ˆğŸ†• æ–°å¢ï¼‰

**åŠŸèƒ½**ï¼šæŒ‰åç§°è·¯å¾„æ¨¡å¼æœç´¢ç¬¦å·ï¼ˆå€Ÿé‰´ Serenaï¼‰

**è¾“å…¥**ï¼š

```json
{
  "code": "...",
  "name_path_pattern": "http/Handle",
  "substring_matching": true,
  "include_kinds": ["function", "method"],
  "max_results": 20
}
```

**è¾“å‡º**ï¼š

```json
{
  "matches": [
    {
      "name": "HandleFunc",
      "name_path": "net/http/HandleFunc",
      "kind": "function",
      "file_path": "net/http/server.go",
      "line": 58,
      "signature": "type HandleFunc func(ResponseWriter, *Request)",
      "match_score": 0.95
    },
    {
      "name": "Handle",
      "name_path": "net/http/Handle",
      "kind": "function",
      "file_path": "net/http/server.go",
      "line": 42,
      "signature": "func Handle(pattern string, handler Handler)",
      "match_score": 0.92
    }
  ]
}
```

#### 8.3.7 search_patternï¼ˆğŸ†• æ–°å¢ï¼‰

**åŠŸèƒ½**ï¼šä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼åœ¨ä»£ç ä¸­æœç´¢æ¨¡å¼ï¼ˆå€Ÿé‰´ Serenaï¼‰

**è¾“å…¥**ï¼š

```json
{
  "code": "package main\n\nfunc main() {\n    if err := doSomething(); err != nil {\n        log.Fatal(err)\n    }\n}",
  "file_path": "main.go",
  "pattern": "if\\s+\\w+\\s*:=\\s*\\w+\\(\\);\\s*\\w+\\s*!=\\s*nil",
  "context_lines_before": 2,
  "context_lines_after": 2
}
```

**è¾“å‡º**ï¼š

```json
{
  "matches": [
    {
      "file_path": "main.go",
      "line": 3,
      "col": 5,
      "matched_text": "if err := doSomething(); err != nil {",
      "context_before": ["func main() {"],
      "context_after": ["        log.Fatal(err)", "    }"]
    }
  ]
}
```

#### 8.3.8 get_call_hierarchyï¼ˆğŸ†• æ–°å¢ï¼‰

**åŠŸèƒ½**ï¼šè·å–å‡½æ•°çš„è°ƒç”¨å±‚æ¬¡ç»“æ„

**è¾“å…¥**ï¼š

```json
{
  "code": "...",
  "file_path": "main.go",
  "line": 10,
  "col": 5,
  "direction": "incoming",
  "depth": 2
}
```

**è¾“å‡º**ï¼š

```json
{
  "symbol": {
    "name": "processRequest",
    "name_path": "processRequest",
    "kind": "function"
  },
  "callers": [
    {
      "name": "main",
      "name_path": "main",
      "file_path": "main.go",
      "line": 25,
      "calls": ["processRequest"]
    },
    {
      "name": "handleRequest",
      "name_path": "handleRequest",
      "file_path": "handler.go",
      "line": 12,
      "calls": ["processRequest", "validateRequest"]
    }
  ]
}
```

#### 8.3.9 list_packagesï¼ˆğŸ†• æ–°å¢ï¼‰

**åŠŸèƒ½**ï¼šåˆ—å‡ºé¡¹ç›®çš„åŒ…ç»“æ„å’Œä¾èµ–å…³ç³»

**è¾“å…¥**ï¼š

```json
{
  "code": "...",
  "include_dependencies": true,
  "depth": 1
}
```

**è¾“å‡º**ï¼š

```json
{
  "packages": [
    {
      "name": "main",
      "path": "github.com/user/project",
      "kind": "command",
      "dependencies": ["net/http", "github.com/gin-gonic/gin"]
    },
    {
      "name": "handler",
      "path": "github.com/user/project/handler",
      "kind": "package",
      "dependencies": ["net/http", "../model"]
    }
  ]
}
```

---

## ä¹ã€åˆ†é˜¶æ®µä»»åŠ¡æ‹†è§£

### é¡¹ç›®æ€»è§ˆç”˜ç‰¹å›¾

```mermaid
gantt
    title gopls-mcp å¼€å‘è®¡åˆ’ï¼ˆ12 å‘¨ï¼‰
    dateFormat  YYYY-MM-DD

    section Phase 1
    é¡¹ç›®åˆå§‹åŒ–           :p1-1, 2026-01-21, 1d
    MCP SDK é›†æˆ         :p1-2, after p1-1, 2d
    gopls å®¢æˆ·ç«¯         :p1-3, after p1-2, 3d
    è™šæ‹Ÿæ–‡æ¡£ç®¡ç†         :p1-4, after p1-3, 2d
    ç¬¬ä¸€ä¸ªå·¥å…·           :p1-5, after p1-4, 3d
    æµ‹è¯•éªŒè¯             :p1-6, after p1-5, 1d

    section Phase 2
    go_to_definition     :p2-1, after p1-6, 2d
    find_references      :p2-2, after p2-1, 2d
    get_hover            :p2-3, after p2-2, 2d
    Bridge å±‚ä¼˜åŒ–        :p2-4, after p2-3, 2d
    é”™è¯¯å¤„ç†å®Œå–„         :p2-5, after p2-4, 1d
    æµ‹è¯•è¡¥å……             :p2-6, after p2-5, 2d

    section Phase 3
    list_symbols         :p3-1, after p2-6, 2d
    get_completions      :p3-2, after p3-1, 2d
    è¿æ¥æ±                :p3-3, after p3-2, 3d
    ç»“æœç¼“å­˜             :p3-4, after p3-3, 2d
    å¹¶å‘æ§åˆ¶             :p3-5, after p3-4, 1d
    æ€§èƒ½æµ‹è¯•             :p3-6, after p3-5, 2d

    section Phase 4
    rename_symbol        :p4-1, after p3-6, 3d
    format_code          :p4-2, after p4-1, 1d
    fix_code             :p4-3, after p4-2, 3d
    go.work æ”¯æŒ         :p4-4, after p4-3, 2d
    æ¨¡å—æ”¯æŒ             :p4-5, after p4-4, 2d
    æ³›å‹æ”¯æŒ             :p4-6, after p4-5, 1d

    section Phase 5
    README ç¼–å†™          :p5-1, after p4-6, 2d
    API æ–‡æ¡£             :p5-2, after p5-1, 1d
    é…ç½®ç³»ç»Ÿ             :p5-3, after p5-2, 2d
    æ—¥å¿—ç³»ç»Ÿ             :p5-4, after p5-3, 1d
    é”™è¯¯æ¢å¤             :p5-5, after p5-4, 2d
    ç«¯åˆ°ç«¯æµ‹è¯•           :p5-6, after p5-5, 2d

    section Phase 6
    Claude é…ç½®          :p6-1, after p5-6, 1d
    Cursor é›†æˆ          :p6-2, after p6-1, 1d
    Homebrew å‘å¸ƒ        :p6-3, after p6-2, 2d
    ç¤ºä¾‹åœºæ™¯             :p6-4, after p6-3, 2d
    ç”¨æˆ·æµ‹è¯•             :p6-5, after p6-4, 3d
    è¿­ä»£ä¼˜åŒ–             :p6-6, after p6-5, 3d
```

### Phase 1: åŸºç¡€æ¡†æ¶æ­å»ºï¼ˆWeek 1-2ï¼‰

**ç›®æ ‡**ï¼šå»ºç«‹å¯è¿è¡Œçš„ MCP Server æ¡†æ¶ï¼Œå®ç°ä¸€ä¸ªåŸºç¡€å·¥å…·

| ä»»åŠ¡             | æè¿°                        | äº¤ä»˜ç‰©                | ä¼°æ—¶   |
| -------------- | ------------------------- | ------------------ | ---- |
| 1.1 é¡¹ç›®åˆå§‹åŒ–      | åˆ›å»ºé¡¹ç›®ç»“æ„ã€é…ç½® go.mod          | é¡¹ç›®éª¨æ¶               | 0.5d |
| 1.2 MCP SDK é›†æˆ | é›†æˆ go-sdk/mcpï¼Œå®ç° stdio ä¼ è¾“ | å¯è¿è¡Œçš„ MCP Server    | 1d   |
| 1.3 gopls å®¢æˆ·ç«¯  | å®ç°åŸºç¡€çš„ gopls è¿›ç¨‹å¯åŠ¨å’Œ LSP è¿æ¥  | goplsclient.Client | 2d   |
| 1.4 è™šæ‹Ÿæ–‡æ¡£ç®¡ç†     | å®ç°æ–‡æ¡£åˆ›å»º/æ›´æ–°/åˆ é™¤çš„ LSP åŒæ­¥      | document.Manager   | 1d   |
| 1.5 ç¬¬ä¸€ä¸ªå·¥å…·      | å®ç° analyze_code å·¥å…·        | analyze_code å¯ç”¨    | 2d   |
| 1.6 æµ‹è¯•éªŒè¯       | ç¼–å†™å•å…ƒæµ‹è¯•ï¼Œæ‰‹åŠ¨éªŒè¯ MCP è°ƒç”¨        | æµ‹è¯•æŠ¥å‘Š               | 0.5d |

**é‡Œç¨‹ç¢‘**ï¼šèƒ½å¤Ÿé€šè¿‡ MCP è°ƒç”¨ analyze_code å¹¶è¿”å›è¯Šæ–­ç»“æœ

---

### Phase 2: æ ¸å¿ƒå·¥å…·å®ç°ï¼ˆWeek 3-4ï¼‰

**ç›®æ ‡**ï¼šå®ç° P0 ä¼˜å…ˆçº§çš„å¯¼èˆªå’ŒæŸ¥è¯¢å·¥å…·

| ä»»åŠ¡ | æè¿° | äº¤ä»˜ç‰© | ä¼°æ—¶ |
|------|------|--------|------|
| 2.1 go_to_definition | å®ç°è·³è½¬å®šä¹‰å·¥å…· | go_to_definition | 1.5d |
| 2.2 find_references | å®ç°æŸ¥æ‰¾å¼•ç”¨å·¥å…· | find_references | 1.5d |
| 2.3 get_hover | å®ç°æ‚¬åœä¿¡æ¯å·¥å…· | get_hover | 1d |
| 2.4 Bridge å±‚ä¼˜åŒ– | æå–å…¬å…±è½¬æ¢é€»è¾‘ï¼Œå‡å°‘é‡å¤ä»£ç  | bridge.Converter | 1d |
| 2.5 é”™è¯¯å¤„ç†å®Œå–„ | ç»Ÿä¸€é”™è¯¯å¤„ç†ï¼Œå¢åŠ å‹å¥½æç¤º | é”™è¯¯å¤„ç†ä¸­é—´ä»¶ | 0.5d |
| 2.6 æµ‹è¯•è¡¥å…… | è¡¥å……å·¥å…·çš„å•å…ƒæµ‹è¯•å’Œé›†æˆæµ‹è¯• | æµ‹è¯•æŠ¥å‘Š | 1d |

**é‡Œç¨‹ç¢‘**ï¼šP0 å·¥å…·å…¨éƒ¨å¯ç”¨ï¼ŒåŸºæœ¬æ»¡è¶³ Go ä»£ç åˆ†æéœ€æ±‚

---

### Phase 3: å¢å¼ºåŠŸèƒ½ï¼ˆWeek 5-6ï¼‰

**ç›®æ ‡**ï¼šå®ç°æ›´å¤šé«˜çº§åŠŸèƒ½å’Œæ€§èƒ½ä¼˜åŒ–

| ä»»åŠ¡ | æè¿° | äº¤ä»˜ç‰© | ä¼°æ—¶ |
|------|------|--------|------|
| 3.1 list_symbols | å®ç°ç¬¦å·åˆ—è¡¨å·¥å…· | list_symbols | 1d |
| 3.2 get_completions | å®ç°ä»£ç è¡¥å…¨å·¥å…· | get_completions | 1.5d |
| 3.3 è¿æ¥æ±  | å®ç° gopls è¿æ¥å¤ç”¨ | connection.Pool | 2d |
| 3.4 ç»“æœç¼“å­˜ | å®ç° LSP æŸ¥è¯¢ç»“æœç¼“å­˜ | cache.Manager | 1.5d |
| 3.5 å¹¶å‘æ§åˆ¶ | é™åˆ¶å¹¶å‘ LSP è¯·æ±‚æ•°ï¼Œé˜²æ­¢è¿‡è½½ | é™æµå™¨ | 0.5d |
| 3.6 æ€§èƒ½æµ‹è¯• | å‹åŠ›æµ‹è¯•ï¼Œä¼˜åŒ–å“åº”æ—¶é—´ | æ€§èƒ½æŠ¥å‘Š | 1d |

**é‡Œç¨‹ç¢‘**ï¼šåŠŸèƒ½å®Œæ•´ï¼Œæ€§èƒ½æ»¡è¶³è¦æ±‚ï¼ˆ<500msï¼‰

---

### Phase 4: é«˜çº§åŠŸèƒ½ï¼ˆWeek 7-8ï¼‰

**ç›®æ ‡**ï¼šå®ç°é‡æ„ç±»å·¥å…·å’Œç‰¹æ®Šåœºæ™¯æ”¯æŒ

| ä»»åŠ¡ | æè¿° | äº¤ä»˜ç‰© | ä¼°æ—¶ |
|------|------|--------|------|
| 4.1 rename_symbol | å®ç°é‡å‘½åå·¥å…· | rename_symbol | 2d |
| 4.2 format_code | å®ç°æ ¼å¼åŒ–å·¥å…· | format_code | 0.5d |
| 4.3 fix_code | å®ç°è‡ªåŠ¨ä¿®å¤å·¥å…·ï¼ˆcodeActionï¼‰ | fix_code | 2d |
| 4.4 go.work æ”¯æŒ | æ”¯æŒ Go å·¥ä½œåŒº | go.work æ–‡æ¡£ | 1d |
| 4.5 æ¨¡å—æ”¯æŒ | å®Œå–„å¤šæ¨¡å—é¡¹ç›®æ”¯æŒ | æµ‹è¯•ç”¨ä¾‹ | 1d |
| 4.6 æ³›å‹æ”¯æŒ | éªŒè¯æ³›å‹ç›¸å…³åœºæ™¯ | æµ‹è¯•æŠ¥å‘Š | 0.5d |

**é‡Œç¨‹ç¢‘**ï¼šåŠŸèƒ½è¦†ç›–ç‡è¾¾ 80%+ï¼Œæ”¯æŒæ‰€æœ‰ Go ç‰¹æ€§

---

### Phase 5: è´¨é‡ä¼˜åŒ–å’Œæ–‡æ¡£ï¼ˆWeek 9-10ï¼‰

**ç›®æ ‡**ï¼šå®Œå–„æ–‡æ¡£ã€æå‡ç¨³å®šæ€§

| ä»»åŠ¡ | æè¿° | äº¤ä»˜ç‰© | ä¼°æ—¶ |
|------|------|--------|------|
| 5.1 README ç¼–å†™ | å®Œå–„é¡¹ç›®æ–‡æ¡£ã€ä½¿ç”¨è¯´æ˜ | README.md | 1d |
| 5.2 API æ–‡æ¡£ | ç”Ÿæˆå·¥å…· API æ–‡æ¡£ | API æ–‡æ¡£ | 0.5d |
| 5.3 é…ç½®ç³»ç»Ÿ | æ”¯æŒé…ç½®æ–‡ä»¶ | config è®¾è®¡ | 1d |
| 5.4 æ—¥å¿—ç³»ç»Ÿ | å®Œå–„æ—¥å¿—è¾“å‡º | logger å®ç° | 0.5d |
| 5.5 é”™è¯¯æ¢å¤ | gopls å´©æºƒè‡ªåŠ¨é‡å¯ | å¥åº·æ£€æŸ¥ | 1d |
| 5.6 ç«¯åˆ°ç«¯æµ‹è¯• | ç¼–å†™å®Œæ•´çš„ E2E æµ‹è¯• | E2E æµ‹è¯• | 1d |

**é‡Œç¨‹ç¢‘**ï¼šé¡¹ç›®å¯å‘å¸ƒ v1.0.0

---

### Phase 6: éƒ¨ç½²å’Œé›†æˆï¼ˆWeek 11-12ï¼‰

**ç›®æ ‡**ï¼šé›†æˆåˆ° AI ç¼–ç¨‹å·¥å…·ï¼Œæ”¶é›†åé¦ˆ

| ä»»åŠ¡ | æè¿° | äº¤ä»˜ç‰© | ä¼°æ—¶ |
|------|------|--------|------|
| 6.1 Claude é…ç½® | ç¼–å†™ Claude MCP é…ç½®æ–‡æ¡£ | é…ç½®ç¤ºä¾‹ | 0.5d |
| 6.2 Cursor é›†æˆ | æµ‹è¯• Cursor é›†æˆ | é›†æˆæ–‡æ¡£ | 0.5d |
| 6.3 Homebrew å‘å¸ƒ | å‘å¸ƒåˆ° Homebrew | Formula | 1d |
| 6.4 ç¤ºä¾‹åœºæ™¯ | ç¼–å†™ä½¿ç”¨ç¤ºä¾‹å’Œè§†é¢‘ | ç¤ºä¾‹ä»“åº“ | 1d |
| 6.5 ç”¨æˆ·æµ‹è¯• | é‚€è¯·ç”¨æˆ·è¯•ç”¨ï¼Œæ”¶é›†åé¦ˆ | åé¦ˆæŠ¥å‘Š | 2d |
| 6.6 è¿­ä»£ä¼˜åŒ– | æ ¹æ®åé¦ˆä¿®å¤é—®é¢˜ | bugfix | 2d |

**é‡Œç¨‹ç¢‘**ï¼šæˆåŠŸå‘å¸ƒå¹¶æœ‰ä¸€å®šç”¨æˆ·åŸºç¡€

---

## åã€æŠ€æœ¯é£é™©å’Œåº”å¯¹

| é£é™© | å½±å“ | æ¦‚ç‡ | åº”å¯¹æªæ–½ |
|------|------|------|----------|
| **gopls ç¨³å®šæ€§é—®é¢˜** | é«˜ | ä¸­ | å®ç°å¥åº·æ£€æŸ¥å’Œè‡ªåŠ¨é‡å¯ï¼Œè¿æ¥æ± éš”ç¦» |
| **LSP åè®®å¤æ‚æ€§** | ä¸­ | é«˜ | ä½¿ç”¨æˆç†Ÿåº“ï¼ˆgo-lspï¼‰ï¼Œé€æ­¥å®ç° |
| **æ€§èƒ½ç“¶é¢ˆ** | ä¸­ | ä¸­ | è¿æ¥æ± ã€ç¼“å­˜ã€å¼‚æ­¥å¤„ç† |
| **MCP SDK å˜æ›´** | ä½ | ä½ | é”å®šç‰ˆæœ¬ï¼Œå…³æ³¨ä¸Šæ¸¸æ›´æ–° |
| **Go ç‰ˆæœ¬å…¼å®¹æ€§** | ä¸­ | ä½ | æ”¯æŒ Go 1.18+ï¼Œæµ‹è¯•å¤šä¸ªç‰ˆæœ¬ |

---

## åä¸€ã€æˆåŠŸæŒ‡æ ‡

| æŒ‡æ ‡ | ç›®æ ‡ | æµ‹é‡æ–¹å¼ |
|------|------|----------|
| **åŠŸèƒ½è¦†ç›–ç‡** | â‰¥ 80% | gopls èƒ½åŠ›çŸ©é˜µå¯¹æ¯” |
| **å“åº”æ—¶é—´** | P50 < 200ms, P95 < 500ms | æ€§èƒ½æµ‹è¯• |
| **è¯Šæ–­å‡†ç¡®ç‡** | â‰¥ 95% | ä¸ go compiler å¯¹æ¯” |
| **å†…å­˜å ç”¨** | < 100MB (idle) | èµ„æºç›‘æ§ |
| **ç”¨æˆ·æ»¡æ„åº¦** | â‰¥ 4.0/5.0 | ç”¨æˆ·åé¦ˆ |

---

## åäºŒã€å‚è€ƒèµ„æº

- **bcindex é¡¹ç›®**ï¼šhttps://github.com/DreamCats/bcindex
- **MCP å®˜æ–¹æ–‡æ¡£**ï¼šhttps://modelcontextprotocol.io
- **MCP Go SDK**ï¼šhttps://github.com/modelcontextprotocol/go-sdk
- **gopls å®˜æ–¹æ–‡æ¡£**ï¼šhttps://golang.org/x/tools/gopls
- **LSP è§„èŒƒ**ï¼šhttps://microsoft.github.io/language-server-protocol/

---

## é™„å½•ï¼šMCP é…ç½®ç¤ºä¾‹

### Claude Desktop é…ç½®

```json
{
  "mcpServers": {
    "gopls": {
      "command": "/path/to/gopls-mcp",
      "args": []
    }
  }
}
```

### Cursor é…ç½®

```json
{
  "mcpServers": [
    {
      "name": "gopls",
      "command": "/path/to/gopls-mcp",
      "args": []
    }
  ]
}
```

---

**æ–‡æ¡£ç‰ˆæœ¬**ï¼šv1.0
**åˆ›å»ºæ—¥æœŸ**ï¼š2026-01-21
**ä½œè€…**ï¼šClaude Code & ä¹°å³°
